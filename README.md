# Скрипты для создания пользователя с sudo и защиты VPS

Этот репозиторий содержит два Bash-скрипта для управления и защиты вашего VPS:
1. **`create_sudo_user.sh`** — Создаёт нового пользователя с правами sudo.
2. **`secure_vps_from_local.sh`** — Защищает ваш VPS, настраивая вход по SSH-ключу, отключая парольный вход и root-доступ, а также устанавливая Fail2ban.

---

## `create_sudo_user.sh`

### Использование:
Запустите скрипт прямо с GitHub (на Вашей VPS через root):

bash <(curl -Ls https://raw.githubusercontent.com/TheDexon/vps-scripts-create-sudo/main/create_sudo_user.sh)

### Как это работает
1. Проверка прав root: Скрипт проверяет, запущен ли он от имени root (или через sudo), так как создание пользователей требует повышенных привилегий.

2. Запрос данных: Запрашивает имя нового пользователя и пароль (с подтверждением).

3. Создание пользователя: Использует useradd для создания пользователя с домашней директорией и оболочкой bash.

4. Установка пароля: Команда chpasswd задаёт пароль для пользователя.

5. Добавление в sudo: Команда usermod -aG sudo добавляет пользователя в группу sudo, предоставляя ему права root через команду sudo.

## `secure_vps_from_local.sh`

### Использование:

Запустите скрипт прямо с GitHub (на локальном компьютере):

bash <(curl -Ls https://raw.githubusercontent.com/TheDexon/vps-scripts-create-sudo/main/secure_vps_from_local.sh)

### Как это работает

1. Запрос данных: Запрашивает IP-адрес VPS, имя пользователя, начальный пароль и пароль для sudo.

2. Генерация SSH-ключа: Если ключа ~/.ssh/id_ed25519 нет, создаёт его с помощью ssh-keygen.

3. Копирование ключа: Использует ssh-copy-id для копирования публичного ключа на сервер с начальным паролем.

4. Проверка подключения: Проверяет, работает ли вход по ключу.

5. Настройка безопасности:

- Отключает парольный вход и root-доступ в /etc/ssh/sshd_config.

- Устанавливает и настраивает Fail2ban для защиты от brute-force атак (5 попыток, бан на 1 час).

- Перезапускает службы sshd и fail2ban.

9. Проверка результата: Убеждается, что всё работает, и выводит инструкции.



